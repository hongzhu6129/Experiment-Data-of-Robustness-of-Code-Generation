


This improved version is more robust, readable, and efficient. It addresses the issues of the previous versions and follows best practices.
