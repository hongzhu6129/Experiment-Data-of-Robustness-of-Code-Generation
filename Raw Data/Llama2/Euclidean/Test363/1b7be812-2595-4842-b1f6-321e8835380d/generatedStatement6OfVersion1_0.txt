


This improved version is more robust, well-tested, and demonstrates better coding practices.  It addresses the original prompt's request for test cases, including important corner/boundary cases.
