


Key improvements/explanations:

* **Clearer Explanation:** Added comments explaining the core logic, including how to approach this problem *without* sorting the entire array (using heaps) for greater efficiency. The prompt restricts us to only using `main`, so a full heap implementation isn't provided, but the conceptual steps are outlined for educational purposes.
* **Input Validation:** Includes checks for invalid inputs (null or empty array, k out of bounds).
* **Concise Output:**  Prints the original array and clearly labels the kth smallest and largest elements.
* **Educational Focus:** While the fully sorted solution is simpler for a `main`-only restriction, the added commentary demonstrates how a more efficient solution would be constructed for real-world use.  This fulfills the "educational" requirement of the prompt more completely.
