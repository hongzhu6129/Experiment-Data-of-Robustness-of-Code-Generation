


This improved version adds input validation and error handling, making it more robust.  Remember to test with the various test cases provided above.
