


Key improvements:

* **Handles edge cases:** The code now correctly handles `null`, empty, and whitespace-only input strings.
* **Case-insensitive comparison:**  The `toLowerCase()` method ensures that words ending in "M" or "N" are also counted.
* **Removes punctuation:** `replaceAll("[^a-zA-Z0-9]", "")` cleans the words by removing any non-alphanumeric characters before checking the ending.  This prevents punctuation from interfering with the result.
* **Clearer variable names:** Using names like `cleanedWord` makes the code easier to understand.
* **More comprehensive testing:**  The `main` method includes several test cases to demonstrate the code's behavior with different inputs.
* **Uses `\\s+` for splitting:**  This handles multiple spaces between words correctly.
