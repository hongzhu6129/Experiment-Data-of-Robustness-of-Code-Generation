


This revised code provides a more robust and testable solution, demonstrating good Java practices.  The test cases help ensure the correctness of the calculations, especially for edge cases.
