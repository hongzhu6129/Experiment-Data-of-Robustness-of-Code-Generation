


**Explanation and Improvements:**

1. **TreeMap for Sorted Order:** Using a `TreeMap` is the most efficient way to get the greatest and least keys because a `TreeMap` automatically stores its keys in sorted order. This avoids the need for manual sorting.

2. **Handling Empty Maps:**  The code now includes a check to see if the map is empty before attempting to retrieve the greatest/least keys.  This prevents `NullPointerExceptions`.

3. **`Collections.lastKey()` and `firstKey()` (TreeMap):** For TreeMaps, these methods provide direct access to the greatest and smallest keys.

4. **`Collections.max()` and `Collections.min()` (General Maps):** The provided code also demonstrates how to find the largest and smallest keys if you are using other Map types like `HashMap` which are not inherently sorted.

5. **Clearer Output:** The output is formatted to clearly indicate the greatest and least key-value pairs.

6. **Example with HashMap:** An additional example with HashMap is included to show the general approach for maps that don't maintain sorted order.  This highlights the advantages of using a `TreeMap` when key order matters.
