


Key improvements in this version:

* **Regex for Word Boundaries:** The `\\b` in the regex ensures that only whole words ending in 'm' or 'n' are counted.  This prevents partial matches like "strum" or "WHIMpers" from being counted.
* **Case-Insensitivity:**  Using the character class `[mnMN]` directly makes the matching case-insensitive, avoiding the need for `toLowerCase()`.
* **Handles Null and Empty Input:** The code now correctly handles `null` and empty strings, returning 0 in those cases.
* **Clearer and More Efficient:** The code is more concise and efficient due to the use of regex.
* **Comprehensive Test Cases:** The `main` method now includes a wider variety of test cases to demonstrate the correct behavior of the code in different scenarios (including null, empty, whitespace-only strings and case variations).
