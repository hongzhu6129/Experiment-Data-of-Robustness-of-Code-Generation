



This improved version includes better input validation and more comprehensive test cases to cover corner cases and potential errors. Remember to thoroughly test your code with various scenarios to ensure its correctness.
