


This improved version would make the code more robust and user-friendly.
