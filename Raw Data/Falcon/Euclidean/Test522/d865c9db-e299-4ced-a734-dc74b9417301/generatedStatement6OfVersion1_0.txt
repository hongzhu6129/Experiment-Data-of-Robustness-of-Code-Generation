


This improved version handles potential overflow, provides clearer code, and uses the correct data type to store the large values of Fermat numbers (to the extent possible).
