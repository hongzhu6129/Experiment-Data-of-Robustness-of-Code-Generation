


Key improvements:

* **Handles edge cases:**  The code now correctly handles empty arrays and arrays with a single element. These edge cases are important for robust code.
* **Clearer logic:**  The logic is more straightforward and easier to follow with the separate handling of edge cases.
* **More test cases:**  The `main` method includes a wider range of test cases to demonstrate the correct behavior in various scenarios.


This improved version addresses the potential issues with `ArrayIndexOutOfBoundsException` and provides a more complete solution.
