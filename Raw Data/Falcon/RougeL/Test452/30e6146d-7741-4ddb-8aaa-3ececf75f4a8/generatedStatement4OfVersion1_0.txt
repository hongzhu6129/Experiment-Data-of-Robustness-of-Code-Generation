



This revised version is more robust, testable, and adheres to better object-oriented principles.  The test cases ensure that the code functions correctly under various conditions, which is crucial for reliable software.
