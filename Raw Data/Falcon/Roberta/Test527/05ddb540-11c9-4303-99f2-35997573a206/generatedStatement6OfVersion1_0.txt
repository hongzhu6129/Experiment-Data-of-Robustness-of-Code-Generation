


This revised code provides a complete and robust solution to the problem, adhering to the specified method signatures and best practices.
